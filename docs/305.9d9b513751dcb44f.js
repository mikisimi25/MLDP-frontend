"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[305],{3334:(M,h,l)=>{l.d(h,{U:()=>K});var _=l(805),s=l(659),u=l(2500),t=l(4650),d=l(2582),f=l(1495),a=l(6895),p=l(4247),g=l(5593),m=l(8433),x=l(2435),E=l(3608),y=l(2453),b=l(2210),C=l(4006);function I(n,r){if(1&n&&(t.TgZ(0,"span",7),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&n){const e=t.oxw();t.Q6J("routerLink","/"+e.type+"/"+("user"!==e.type?e.content.id:e.content.username)),t.xp6(1),t.hij(" ","movie"===e.type?e.content.original_title:t.lcZ(2,2,"tv"===e.type?e.content.original_name:e.content.username)," ")}}function L(n,r){if(1&n&&t._UZ(0,"button",12),2&n){const e=t.oxw(3);t.Q6J("label",null==e.content?null:e.content.vote_average)}}function O(n,r){if(1&n&&(t.TgZ(0,"div",9),t._UZ(1,"img",10),t.YNc(2,L,1,1,"button",11),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("src",null!=e.content&&e.content.poster_path?"https://image.tmdb.org/t/p/w500"+e.content.poster_path:"https://png.clipart.me/previews/90c/movie-poster-background-vector-material-17011.jpg",t.LSH)("routerLink","/"+e.type+"/"+("user"!==e.type?e.content.id:e.content.username)),t.xp6(1),t.Q6J("ngIf",e.content.vote_average)}}function A(n,r){if(1&n&&t.YNc(0,O,3,3,"div",8),2&n){const e=t.oxw();t.Q6J("ngIf","user"!==e.type)}}function P(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",17)(1,"button",18),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.addFollower(i.content.id))}),t.qZA()()}}function w(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",19)(1,"button",20),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.addToViewed(i.type+"/"+i.content.id))}),t.qZA()()}if(2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("icon",e.viewed?"fa-solid fa-eye":"fa-regular fa-eye")}}function S(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",19)(1,"button",21),t.NdJ("click",function(i){t.CHM(e),t.oxw(3);const c=t.MAs(6);return t.KtG(c.toggle(i))}),t.qZA()()}}function R(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",19)(1,"button",22),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.deleteContentFromList(i.content.id))}),t.qZA()()}}function N(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",19)(1,"button",23),t.NdJ("click",function(i){t.CHM(e),t.oxw(3);const c=t.MAs(9);return t.KtG(c.toggle(i))}),t.qZA()()}if(2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("icon",e.selectedRating?"fa-solid fa-star":"fa-regular fa-star")}}function D(n,r){if(1&n&&(t.TgZ(0,"div",14),t.YNc(1,P,2,0,"div",15),t.YNc(2,w,2,1,"div",16),t.YNc(3,S,2,0,"div",16),t.YNc(4,R,2,0,"div",16),t.YNc(5,N,2,1,"div",16),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",(null==e.user?null:e.user.username)!==e.content.username&&"user"===e.type),t.xp6(1),t.Q6J("ngIf",e.crud&&"user"!==e.type),t.xp6(1),t.Q6J("ngIf",e.crud&&"user"!==e.type),t.xp6(1),t.Q6J("ngIf",e.crud&&"user"!==e.type&&e.deleteButton),t.xp6(1),t.Q6J("ngIf",e.crud&&"user"!==e.type&&e.viewed)}}function U(n,r){if(1&n&&t.YNc(0,D,6,5,"div",13),2&n){const e=t.oxw();t.Q6J("ngIf",e.isLoggedIn)}}function k(n,r){if(1&n&&(t.TgZ(0,"div",26)(1,"span"),t._uU(2),t.qZA()()),2&n){const e=r.$implicit;t.xp6(2),t.Oqu(e.label)}}const Z=function(){return{width:"15rem"}},B=function(){return{"max-height":"250px"}};function J(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"p-listbox",24),t.NdJ("ngModelChange",function(i){t.CHM(e);const c=t.oxw();return t.KtG(c.selectedLists=i)})("onClick",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.toggleAdd(i.content.id,i.selectedLists))}),t.YNc(1,k,3,1,"ng-template",25),t.qZA()}if(2&n){const e=t.oxw();t.Akn(t.DdM(11,Z)),t.Q6J("showToggleAll",!1)("filter",!1)("options",e.groupedLists)("group",!0)("ngModel",e.selectedLists)("metaKeySelection",!1)("checkbox",!0)("multiple",!0)("listStyle",t.DdM(12,B))}}let K=(()=>{class n{constructor(e,o,i){this.activatedRoute=e,this.messageService=o,this.store=i,this.type=this.activatedRoute.snapshot.data.content,this.crud=!0,this.deleteButton=!1,this.groupedLists=[],this.oldCollection=[],this.selectedLists=[],this.isLoggedIn=!1,this.user=void 0,this._subscriptions=[],this.viewed=!1,this.ratingColl=[],this.selectedRating=null}ngOnInit(){this.groupedLists=[{label:"Mis Listas",value:"ml",items:[]}];for(let e=1;e<=10;e++)this.ratingColl.push(e);this._subscriptions.push(this.store.select("auth").subscribe(({user:e,isLoggedIn:o})=>{this.isLoggedIn=o,this.user=e,this.viewed=!1,this.selectedRating=this.setRaiting()})),this._subscriptions.push(this.store.select("list").subscribe(({lists:e})=>{this.groupedLists[0].items=e,e.length>0&&this.uploadChecks(this.groupedLists[0].items)}))}ngOnDestroy(){this._subscriptions.forEach(e=>e.unsubscribe())}uploadChecks(e){this.sliceOption="movie"==this.type?6:3,this.selectedLists=[],e.length>0&&e?.forEach(o=>{JSON.parse(o.contentId).forEach(c=>{(c=c.toString().slice(this.sliceOption))==this.content.id&&(2==o.user_list_count&&(this.viewed=!0),this.selectedLists.push(o),this.oldCollection=this.selectedLists)})})}toggleAdd(e,o){if(this.oldCollection>o){let i=this.catchDeletetedList(this.oldCollection,o);this.store.dispatch(s.nz({id:i.user_list_count,content:this.type+"/"+e.toString()})),this.messageService.add({severity:"warn",summary:"Pel\xedcula descartada de la lista de "+i.title})}else if(o.length>0){const i=o.slice(-1)[0]||0;this.store.dispatch(s.tA({list:i,content:this.type+"/"+e.toString()})),this.messageService.add({severity:"success",summary:"Pel\xedcula a\xf1adida a la lista de "+o.slice(-1)[0].title})}}addToViewed(e){this.viewed?(this.store.dispatch(s.nz({id:2,content:e.toString()})),this.messageService.add({severity:"warn",summary:"Pel\xedcula descartada de la lista de Vistos"}),this.viewed=!1):(this.store.dispatch(s.tA({list:{username:this.user?.username,user_list_count:2},content:e.toString()})),this.messageService.add({severity:"success",summary:"Pel\xedcula a\xf1adida a la lista de Vistos"}))}addFollower(e){this.store.dispatch(u.ZN({userId:this.user?.id,followId:e}))}deleteContentFromList(e){this.activatedRoute.params.subscribe(({listId:o})=>{this.store.dispatch(s.nz({id:o,content:this.type+"/"+e}))})}setRaiting(){const i=new Map(JSON.parse(localStorage.getItem("ratingColl"))).get(this.type+"/"+this.content.id);return void 0!==i?i:null}changeRating(){const e=new Map(JSON.parse(localStorage.getItem("ratingColl"))),o=this.type+"/"+this.content.id;this.selectedRating?e.set(o,this.selectedRating):e.delete(o),localStorage.setItem("ratingColl",JSON.stringify(Array.from(e.entries())))}catchDeletetedList(e,o){let v,c=o;return e.forEach(T=>{-1==c.findIndex(W=>W.user_list_count===T.user_list_count)&&(v=T)}),v}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.gz),t.Y36(_.ez),t.Y36(f.yh))},n.\u0275cmp=t.Xpm({type:n,selectors:[["component-small-info-card"]],inputs:{content:"content",type:"type",crud:"crud",deleteButton:"deleteButton"},features:[t._Bn([_.ez])],decls:11,vars:3,consts:[["pTemplate","title"],["pTemplate","content"],["pTemplate","footer","style","padding: 0 !important;"],["op",""],["pTemplate",""],["rating",""],["placeholder","Puntuaci\xf3n personal",3,"options","ngModel","showClear","ngModelChange","onChange"],[3,"routerLink"],["class","imageContainer",4,"ngIf"],[1,"imageContainer"],["alt","Card",2,"width","100%",3,"src","routerLink"],["pButton","","pRipple","","type","button","class","p-button-rounded p-button-secondary",3,"label",4,"ngIf"],["pButton","","pRipple","","type","button",1,"p-button-rounded","p-button-secondary",3,"label"],["class","grid mt-1","style","text-align: center",4,"ngIf"],[1,"grid","mt-1",2,"text-align","center"],["class","col-12","style","text-align: right",4,"ngIf"],["class","col",4,"ngIf"],[1,"col-12",2,"text-align","right"],["pButton","","pRipple","","icon","pi pi-user-plus","pTooltip","Seguir al usuario",1,"p-button-rounded",3,"click"],[1,"col"],["pButton","","pRipple","","type","button","pTooltip","Visto",1,"p-button-rounded","p-button-help",3,"icon","click"],["pButton","","pRipple","","type","button","icon","pi pi-bookmark","pTooltip","A\xf1adir a una lista",1,"p-button-rounded","p-button-warning",3,"click"],["pButton","","pRipple","","type","button","icon","pi pi-times","pTooltip","Quitar de la lista",1,"p-button-rounded","p-button-danger",3,"click"],["pButton","","pRipple","","type","button","pTooltip","Puntuar",1,"p-button-rounded","p-button-warning",3,"icon","click"],["optionLabel","title",3,"showToggleAll","filter","options","group","ngModel","metaKeySelection","checkbox","multiple","listStyle","ngModelChange","onClick"],["pTemplate","group"],[1,"flex","align-items-center"]],template:function(e,o){1&e&&(t._UZ(0,"p-toast"),t.TgZ(1,"p-card"),t.YNc(2,I,3,4,"ng-template",0),t.YNc(3,A,1,1,"ng-template",1),t.YNc(4,U,1,1,"ng-template",2),t.TgZ(5,"p-overlayPanel",null,3),t.YNc(7,J,2,13,"ng-template",4),t.qZA(),t.TgZ(8,"p-overlayPanel",null,5)(10,"p-dropdown",6),t.NdJ("ngModelChange",function(c){return o.selectedRating=c})("onChange",function(){return o.changeRating()}),t.qZA()()()),2&e&&(t.xp6(10),t.Q6J("options",o.ratingColl)("ngModel",o.selectedRating)("showClear",!0))},dependencies:[a.O5,p.Z,_.jx,g.Hq,m.Ri,x.T,d.rH,E.u,y.FN,b.Lt,C.JJ,C.On,a.rS],styles:["[_nghost-%COMP%]     img, [_nghost-%COMP%]     span{cursor:pointer}[_nghost-%COMP%]     .points{width:50px;height:50px;overflow:hidden}[_nghost-%COMP%]     .points span{font-family:Poppins,sans-serif;font-size:1.5em;font-weight:700;color:#16a34a}[_nghost-%COMP%]     .p-card-body{padding-top:0}[_nghost-%COMP%]     .p-card, [_nghost-%COMP%]     .p-card-footer, [_nghost-%COMP%]     .p-card-content{padding:0!important}[_nghost-%COMP%]     .p-card-title{width:100%;height:35px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;text-align:center}[_nghost-%COMP%]     .imageContainer{height:311.78px;overflow:hidden;position:relative}[_nghost-%COMP%]     .imageContainer img{height:100%}[_nghost-%COMP%]     .imageContainer button{bottom:5px;right:5px;opacity:.9;position:absolute}"]}),n})()},3747:(M,h,l)=>{l.d(h,{_:()=>t});var _=l(529),s=l(2340),u=l(4650);let t=(()=>{class d{constructor(a){this.http=a,this._baseUrlImg="https://image.tmdb.org/t/p/w500/zFTLPipninMF4THDbdkQUZLWMEw.jpg"}popularMoviesOrTv(a,p=1){const g=(new _.LE).set("api_key",s.N.tmdbApiToken).set("language","es").set("page",p);return this.http.get("movie"===a?`${s.N.tmdbApiURL}/3/movie/popular`:`${s.N.tmdbApiURL}/3/tv/popular`,{params:g})}getImagesOfMovieOrTvshows(a){const p=(new _.LE).set("api_key",s.N.tmdbApiToken).set("language","es");return this.http.get(`${s.N.tmdbApiURL}/3/${a}/images`,{params:p})}getMovieOrTvshowsById(a){const p=(new _.LE).set("api_key",s.N.tmdbApiToken).set("language","es");return this.http.get(`${s.N.tmdbApiURL}/3/${a}`,{params:p})}getMovieOrTvshowsSearchResult(a,p,g=1){const m=(new _.LE).set("api_key",s.N.tmdbApiToken).set("language","es").set("query",p).set("page",g).set("include_adult",!1);return this.http.get("movie"===a?`${s.N.tmdbApiURL}/3/search/movie`:`${s.N.tmdbApiURL}/3/search/tv`,{params:m})}getMovieOrTvshowsCategories(a){const p=(new _.LE).set("api_key",s.N.tmdbApiToken).set("language","es");return this.http.get("movie"===a?`${s.N.tmdbApiURL}/3/genre/movie/list`:`${s.N.tmdbApiURL}/3/genre/tv/list`,{params:p})}getContentTrailer(a,p){const g=(new _.LE).set("api_key",s.N.tmdbApiToken);return this.http.get("movie"===a?`${s.N.tmdbApiURL}/3/movie/${p}/videos`:`${s.N.tmdbApiURL}/3/tv/${p}/videos`,{params:g})}}return d.\u0275fac=function(a){return new(a||d)(u.LFG(_.eN))},d.\u0275prov=u.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()}}]);